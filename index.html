<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lionime-anime - Home</title>
  <style>
    /* Variabel Warna untuk Tema Gelap */
    :root {
      --bg-primary: #121212;
      --bg-secondary: #1e1e1e;
      --text-primary: #ffffff;
      --text-secondary: #b3b3b3;
      --accent: #bb86fc; /* Warna ungu terang sebagai aksen */
      --card-bg: #2d2d2d;
      --border-radius: 8px;
      --spacing-small: 8px;
      --spacing-medium: 16px;
      --spacing-large: 24px;
      --header-height: 70px;
      --hero-height: 400px; /* Tinggi untuk slider hero */
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box; /* Penting untuk responsif */
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: var(--bg-primary);
      color: var(--text-primary);
      margin: 0;
      padding: 0;
      padding-top: var(--header-height); /* Memberi ruang untuk header sticky */
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    header {
      background-color: var(--bg-secondary);
      padding: var(--spacing-medium);
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
      position: fixed; /* Header tetap di atas */
      top: 0;
      left: 0;
      right: 0;
      z-index: 1000; /* Harus di atas konten lain */
      height: var(--header-height);
      display: flex;
      justify-content: space-between; /* Logo & Pencarian di kanan, nav di kiri */
      align-items: center;
    }

    .header-content {
      max-width: 1200px;
      margin: auto;
      width: 100%;
      display: flex;
      justify-content: space-between; /* Antara kiri (nav+logo) dan kanan (pencarian) */
      align-items: center;
    }

    /* Wrapper untuk logo dan navigasi */
    .logo-nav-container {
        display: flex;
        align-items: center;
    }

    h1 {
      margin: 0;
      font-size: 1.8rem;
      color: var(--accent);
      margin-right: var(--spacing-medium); /* Jarak antara logo dan nav */
    }

    nav ul {
      list-style-type: none;
      margin: 0;
      padding: 0;
      display: flex;
    }

    nav li {
      margin-left: var(--spacing-medium);
    }

    nav a {
      color: var(--text-primary);
      text-decoration: none;
      font-weight: 500;
      transition: color 0.3s ease;
    }

    nav a:hover {
      color: var(--accent);
    }

    /* Style untuk form pencarian */
    .search-container {
        display: flex;
        align-items: center;
    }

    .search-input {
        padding: 8px 12px;
        border: 1px solid var(--text-secondary);
        border-radius: 4px 0 0 4px;
        background-color: var(--bg-primary);
        color: var(--text-primary);
        outline: none;
        width: 200px;
    }

    .search-input:focus {
        border-color: var(--accent);
    }

    .search-button {
        padding: 8px 12px;
        border: 1px solid var(--text-secondary);
        border-left: none;
        border-radius: 0 4px 4px 0;
        background-color: var(--bg-primary);
        color: var(--text-secondary);
        cursor: pointer;
        font-size: 1rem;
        transition: background-color 0.3s ease, color 0.3s ease;
    }

    .search-button:hover {
        background-color: var(--accent);
        color: var(--bg-primary);
    }

    main {
      flex: 1;
      padding: var(--spacing-large);
      max-width: 1200px;
      width: 100%;
      margin: auto;
    }

    /* Slider Hero */
    .hero-slider {
        width: 100%;
        height: var(--hero-height);
        border-radius: var(--border-radius);
        overflow: hidden;
        position: relative;
        margin-bottom: var(--spacing-large);
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.5);
    }

    .hero-slide {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        opacity: 0;
        transition: opacity 1s ease-in-out;
        display: flex;
        align-items: flex-end; /* Letakkan info di bawah gambar */
        background-size: cover;
        background-position: center;
    }

    .hero-slide.active {
        opacity: 1;
    }

    .hero-info {
        background: linear-gradient(to top, rgba(0, 0, 0, 0.9), transparent);
        padding: var(--spacing-large);
        width: 100%;
    }

    .hero-title {
        font-size: 1.8rem;
        margin: 0 0 var(--spacing-small) 0;
    }

    .hero-meta {
        color: var(--text-secondary);
        font-size: 0.9rem;
        margin: 0;
    }

    /* Section Title */
    .section-title {
      font-size: 1.5rem;
      margin-bottom: var(--spacing-medium);
      color: var(--text-primary);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .section-title a {
        color: var(--accent);
        text-decoration: none;
        font-size: 0.9rem;
    }

    .section-title a:hover {
        text-decoration: underline;
    }

    /* Anime Grid */
    .anime-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); /* Kartu sedikit lebih kecil untuk grid banyak */
      gap: var(--spacing-medium);
      margin-bottom: var(--spacing-large);
    }

    .anime-card {
      background-color: var(--card-bg);
      border-radius: var(--border-radius);
      overflow: hidden;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      cursor: pointer;
      display: flex;
      flex-direction: column;
    }

    .anime-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
    }

    .anime-poster {
      width: 100%;
      height: 190px; /* Proporsi poster disesuaikan */
      object-fit: cover;
      display: block;
    }

    .anime-info {
      padding: var(--spacing-small);
      flex-grow: 1; /* Info mengisi ruang kosong */
      display: flex;
      flex-direction: column;
    }

    .anime-title {
      font-size: 0.85rem;
      margin: 0 0 4px 0;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .anime-meta {
      font-size: 0.75rem;
      color: var(--text-secondary);
      margin: 0;
      margin-top: auto; /* Dorong ke bawah */
    }

    /* Top 10 List Style */
    .top-list {
        display: flex;
        flex-direction: column;
        gap: var(--spacing-small);
    }

    .top-list-item {
        display: flex;
        align-items: center;
        background-color: var(--card-bg);
        padding: var(--spacing-small);
        border-radius: var(--border-radius);
        transition: background-color 0.3s ease;
    }

    .top-list-item:hover {
        background-color: #3a3a3a;
    }

    .top-rank {
        font-size: 1.2rem;
        font-weight: bold;
        color: var(--accent);
        min-width: 30px; /* Agar posisi tetap rata */
        text-align: center;
        margin-right: var(--spacing-small);
    }

    .top-info {
        flex-grow: 1;
    }

    .top-title {
        font-size: 0.9rem;
        margin: 0 0 2px 0;
    }

    .top-meta {
        font-size: 0.75rem;
        color: var(--text-secondary);
        margin: 0;
    }

    .loading, .error {
        text-align: center;
        padding: var(--spacing-large);
        color: var(--text-secondary);
    }

    .error {
        color: #cf6679;
    }

    footer {
      background-color: var(--bg-secondary);
      padding: var(--spacing-medium);
      text-align: center;
      color: var(--text-secondary);
      margin-top: auto;
    }

    /* Media Query Responsif */
    @media (max-width: 768px) {
        :root {
            --hero-height: 250px; /* Kurangi tinggi hero di mobile */
        }
        .header-content {
            flex-direction: column;
            align-items: stretch; /* Rentangkan agar pencarian penuh lebar */
        }
        .logo-nav-container {
            width: 100%; /* Agar nav bisa wrap dengan benar */
            justify-content: flex-start; /* Rata kiri */
            margin-bottom: var(--spacing-medium); /* Jarak ke pencarian */
        }
        nav ul {
            flex-wrap: wrap; /* Bungkus menu jika terlalu panjang */
            gap: var(--spacing-small); /* Gunakan gap untuk jarak */
        }
        nav li {
            margin: 0; /* Hapus margin kiri dari li */
        }
        .search-container {
            width: 100%; /* Pencarian penuhi lebar */
        }
        .search-input {
            width: 100%; /* Input penuhi lebar container */
        }
        .anime-grid {
            grid-template-columns: repeat(auto-fill, minmax(110px, 1fr)); /* Lebih banyak kolom di mobile */
            gap: calc(var(--spacing-medium) / 2);
        }
        .hero-title { font-size: 1.4rem; }
        .hero-meta { font-size: 0.8rem; }
    }
  </style>
</head>
<body>

  <header>
    <div class="header-content">
      <div class="logo-nav-container">
        <h1>Lionime-anime</h1>
        <nav>
          <ul>
            <li><a href="#" onclick="loadPage('home')">Home</a></li>
            <li><a href="#" onclick="loadPage('ongoing')">Ongoing</a></li>  <!-- Diubah -->
            <li><a href="#" onclick="loadPage('completed')">Completed</a></li> <!-- Diubah -->
            <li><a href="#" onclick="loadPage('popular')">Populer</a></li>
          </ul>
        </nav>
      </div>
      <!-- Form pencarian di sisi kanan -->
      <div class="search-container">
          <input type="text" id="search-input" class="search-input" placeholder="Cari Anime...">
          <button onclick="performSearch()" class="search-button">üîç</button>
      </div>
    </div>
  </header>

  <main id="main-content">
    <div class="loading">Memuat halaman utama...</div>
  </main>

  <footer>
    <p>&copy; 2026 Lionime-anime. Hak Cipta Dilindungi.</p>
  </footer>

  <script>
    const API_BASE = 'https://www.sankavollerei.com/anime/samehadaku';
    const mainContent = document.getElementById('main-content');
    const searchInput = document.getElementById('search-input');

    function formatImageUrl(url) {
        if (!url) return 'placeholder.jpg';
        if (url.startsWith('//')) {
            return 'https:' + url;
        }
        return url.trim();
    }

    function renderHeroSlider(animes) {
        if (!animes || animes.length === 0) return '';
        const slides = animes.slice(0, 3);
        let html = '<div class="hero-slider">';
        slides.forEach((anime, index) => {
            const isActive = index === 0 ? 'active' : '';
            const imageUrl = formatImageUrl(anime.poster);
            html += `
                <div class="hero-slide ${isActive}" style="background-image: url('${imageUrl}');">
                    <div class="hero-info">
                        <h2 class="hero-title">${anime.title}</h2>
                        <p class="hero-meta">Episode ${anime.episodes} | Terbaru ${anime.releasedOn}</p>
                    </div>
                </div>
            `;
        });
        html += '</div>';
        return html;
    }

    function createAnimeCard(anime) {
        const card = document.createElement('div');
        card.className = 'anime-card';

        const imageUrl = formatImageUrl(anime.poster);

        let metaText = '';
        if (anime.type) metaText += `${anime.type} `;
        if (anime.episodes) metaText += `Ep ${anime.episodes}`;
        else if (anime.releaseDate) metaText += `Rilis: ${anime.releaseDate}`;
        else if (anime.releasedOn) metaText += anime.releasedOn;
        else if (anime.score && anime.score.trim() !== '') metaText += `Skor: ${anime.score}`;
        else if (anime.status) metaText += anime.status;
        else metaText = 'Info Tidak Tersedia';

        card.innerHTML = `
            <img src="${imageUrl}" alt="${anime.title}" class="anime-poster" loading="lazy">
            <div class="anime-info">
                <h3 class="anime-title">${anime.title}</h3>
                <p class="anime-meta">${metaText.trim()}</p>
            </div>
        `;
        return card;
    }

    function createTopListItem(anime) {
        const item = document.createElement('div');
        item.className = 'top-list-item';

        let metaText = '';
        if (anime.type) metaText += `${anime.type} `;
        if (anime.episodes) metaText += `Ep ${anime.episodes}`;
        else if (anime.releaseDate) metaText += `Rilis: ${anime.releaseDate}`;
        else if (anime.releasedOn) metaText += anime.releasedOn;
        else if (anime.score && anime.score.trim() !== '') metaText += `Skor: ${anime.score}`;
        else if (anime.status) metaText += anime.status;
        else metaText = 'Info Tidak Tersedia';

        item.innerHTML = `
            <div class="top-rank">#${anime.rank}</div>
            <div class="top-info">
                <h3 class="top-title">${anime.title}</h3>
                <p class="top-meta">${metaText.trim()}</p>
            </div>
        `;
        return item;
    }

    function displayAnimesGrid(animes, title = 'Hasil', link = '#') {
        if (!animes || !Array.isArray(animes) || animes.length === 0) {
             return `<div class="error">Tidak ada ${title.toLowerCase()} ditemukan.</div>`;
        }

        let html = `<div><h2 class="section-title">${title} <a href="${link}">Lihat Semua ></a></h2>`;
        html += '<div class="anime-grid">';

        animes.forEach(anime => {
            const card = createAnimeCard(anime);
            html += `<div class="anime-card-wrapper">${card.outerHTML}</div>`;
        });

        html += '</div></div>';
        return html;
    }

    function displayTop10(animes, title = 'Top 10') {
         if (!animes || !Array.isArray(animes) || animes.length === 0) {
             return `<div class="error">Tidak ada ${title.toLowerCase()} ditemukan.</div>`;
        }
        let html = `<div><h2 class="section-title">${title}</h2>`;
        html += '<div class="top-list">';

        animes.forEach(anime => {
            const item = createTopListItem(anime);
            html += item.outerHTML;
        });

        html += '</div></div>';
        return html;
    }

    function showError(message) {
        mainContent.innerHTML = `<div class="error">${message}</div>`;
    }

    function showLoading() {
        mainContent.innerHTML = '<div class="loading">Memuat...</div>';
    }

    async function searchAnimes(query) {
        if (!query) {
             mainContent.innerHTML = `<div class="error">Silakan masukkan kata kunci pencarian.</div>`;
             return;
        }
        showLoading();
         try {
            const response = await fetch(`${API_BASE}/search?q=${encodeURIComponent(query)}&page=1`);
            if (!response.ok) {
                throw new Error(`Gagal mencari anime. Status: ${response.status}`);
            }
            const data = await response.json();
            console.log("Data Search:", data);
            const results = data.data?.animeList || [];
            const html = displayAnimesGrid(results, `Hasil Pencarian untuk "${query}"`);
            mainContent.innerHTML = html;

            if(results.length === 0) {
                mainContent.innerHTML = `<div class="error">Pencarian untuk "${query}" tidak ditemukan.</div>`;
            }

        } catch (error) {
            console.error("Error searching ", error);
            showError('Gagal melakukan pencarian.');
        }
    }

    function performSearch() {
        const query = searchInput.value.trim();
        if(query) {
            searchAnimes(query);
        } else {
            alert("Silakan masukkan judul anime yang ingin dicari.");
        }
    }

    searchInput.addEventListener('keypress', function(event) {
        if (event.key === 'Enter') {
            performSearch();
        }
    });

    async function loadHomePage() {
        showLoading();
        try {
            const response = await fetch(`${API_BASE}/home`);
            if (!response.ok) {
                throw new Error(`Gagal memuat halaman utama. Status: ${response.status}`);
            }
            const data = await response.json();
            console.log("Data Home:", data);

            const recentAnimes = data.data?.recent?.animeList || [];
            const top10Animes = data.data?.top10?.animeList || [];
            const movieAnimes = data.data?.movie?.animeList || [];

            mainContent.innerHTML = '';

            if(recentAnimes.length > 0) {
                mainContent.innerHTML += renderHeroSlider(recentAnimes);
            }
            if(top10Animes.length > 0) {
                mainContent.innerHTML += displayTop10(top10Animes, 'Top 10 Anime');
            }
            if(recentAnimes.length > 0) {
                mainContent.innerHTML += displayAnimesGrid(recentAnimes.slice(0, 10), 'Anime Terbaru', '/recent');
            }
            if(movieAnimes.length > 0) {
                mainContent.innerHTML += displayAnimesGrid(movieAnimes.slice(0, 10), 'Film Terbaru', '/movies');
            }

            if(!recentAnimes.length && !top10Animes.length && !movieAnimes.length) {
                 mainContent.innerHTML = `<div class="error">Data halaman utama tidak lengkap.</div>`;
            }

            initSlider();

        } catch (error) {
            console.error("Error fetching home ", error);
            showError('Gagal memuat data halaman utama.');
        }
    }

    async function loadRecentAnimes() {
        showLoading();
        try {
            const response = await fetch(`${API_BASE}/recent?page=1`);
            if (!response.ok) {
                throw new Error(`Gagal memuat anime terbaru. Status: ${response.status}`);
            }
            const data = await response.json();
            console.log("Data Recent:", data);
            const html = displayAnimesGrid(data.data?.animeList || [], 'Anime Terbaru');
            mainContent.innerHTML = html;
        } catch (error) {
            console.error("Error fetching recent ", error);
            showError('Gagal memuat anime terbaru.');
        }
    }

    async function loadOngoingAnimes() { // Diubah nama fungsi
        showLoading();
         try {
            const response = await fetch(`${API_BASE}/ongoing?page=1`); // Diubah endpoint
            if (!response.ok) {
                throw new Error(`Gagal memuat anime ongoing. Status: ${response.status}`);
            }
            const data = await response.json();
            console.log("Data Ongoing:", data);
            const html = displayAnimesGrid(data, 'Anime Ongoing'); // Diubah judul
            mainContent.innerHTML = html;
        } catch (error) {
            console.error("Error fetching ongoing ", error);
            showError('Gagal memuat anime ongoing.');
        }
    }

     async function loadCompletedAnimes() { // Diubah nama fungsi
        showLoading();
         try {
            const response = await fetch(`${API_BASE}/completed?page=1`); // Diubah endpoint
            if (!response.ok) {
                throw new Error(`Gagal memuat anime completed. Status: ${response.status}`);
            }
            const data = await response.json();
            console.log("Data Completed:", data);
            const html = displayAnimesGrid(data, 'Anime Completed'); // Diubah judul
            mainContent.innerHTML = html;
        } catch (error) {
            console.error("Error fetching completed ", error);
            showError('Gagal memuat anime completed.');
        }
    }

     async function loadPopularAnimes() {
        showLoading();
         try {
            const response = await fetch(`${API_BASE}/popular?page=1`);
            if (!response.ok) {
                throw new Error(`Gagal memuat anime populer. Status: ${response.status}`);
            }
            const data = await response.json();
            console.log("Data Popular:", data);
            const html = displayAnimesGrid(data, 'Anime Terpopuler');
            mainContent.innerHTML = html;
        } catch (error) {
            console.error("Error fetching popular ", error);
            showError('Gagal memuat anime populer.');
        }
    }

    function loadPage(pageName) {
        searchInput.value = ''; // Kosongkan input saat pindah halaman
        switch(pageName) {
            case 'home':
                loadHomePage();
                break;
            case 'recent':
                 loadRecentAnimes();
                 break;
            case 'ongoing': // Diubah case
                loadOngoingAnimes();
                break;
            case 'completed': // Diubah case
                loadCompletedAnimes();
                break;
            case 'popular':
                loadPopularAnimes();
                break;
            default:
                loadHomePage();
        }
    }

    function initSlider() {
        const slides = document.querySelectorAll('.hero-slide');
        if (slides.length <= 1) return;

        let currentIndex = 0;

        function showSlide(index) {
            slides.forEach(slide => slide.classList.remove('active'));
            slides[index].classList.add('active');
        }

        function nextSlide() {
            currentIndex = (currentIndex + 1) % slides.length;
            showSlide(currentIndex);
        }

        setInterval(nextSlide, 5000);
    }

    window.onload = () => {
        loadHomePage();
    };

  </script>

</body>
</html>
